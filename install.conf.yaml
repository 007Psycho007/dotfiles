- defaults:
    link:
      create: true
      relink: true

# safer than nuking all of ~, but adjust to taste
- clean: ['~/.config']

- create:
    - ~/.config
    - ~/.local/bin
    - ~/.config/systemd/user

- link:
    # shell
    ~/.zshrc: config/zsh/.zshrc
    # fish
    ~/.config/fish/config.fish: config/fish/config.fish
    # kitty
    ~/.config/kitty/kitty.conf: config/kitty/kitty.conf
    # rofi
    ~/.config/rofi/config.rasi: config/rofi/config.rasi
    ~/.config/rofi/onedark.rasi: config/rofi/onedark.rasi
    # hyprland + hyprlock + hyprpaper
    ~/.config/hypr/hyprland.conf: config/hypr/hyprland.conf
    ~/.config/hypr/hyprlock.conf: config/hypr/hyprlock.conf
    ~/.config/hypr/hyprpaper.conf: config/hypr/hyprpaper.conf
    # starship
    ~/.config/starship.toml: config/starship/starship.toml
    # extras from xdg.configFile.*
    ~/.config/qtile: config/qtile
    ~/.config/waybar: config/waybar
    ~/.config/files: config/files
    ~/.config/nvim: config/nvim
    ~/.config/scripts: config/scripts

# ---- Repo packages via omnipkg ----
- omnipkg:
  - install:
    - sddm
    - vim
    - wget
    - zsh
    - fish
    - firefox
    - rofi-wayland
    - feh
    - git
    - jq
    - cmake
    - make
    - gcc
    - libtool
    - xclip
    - bluez
    - bitwarden
    - ripgrep
    - waybar
    - hyprpaper
    - kanshi
    - wdisplays
    - thunderbird
    - discord
    - starship
    - base-devel

# ---- AUR packages via yay ----
- yay:
  - nerd-fonts-git
  - dragon-drag-and-drop
  - swaynotificationcenter
  - hyprshot
  - hyprland
  - hyprlock

# ---- Post steps ----
- shell:
    - description: "Enable lingering for user services"
      command: |
        if command -v loginctl >/dev/null; then
          loginctl enable-linger "$USER" || true
        fi

    - description: "Refresh font cache"
      command: |
        [[ -d "$HOME/.local/share/fonts" ]] && fc-cache -f || true

    - description: "Cleanup"
      command: rm -rf ~/.init || true

    - description: "Enable display manager (sddm) for graphical login"
      command: |
        sudo systemctl enable sddm.service
