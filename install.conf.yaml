- defaults:
    link:
      create: true
      relink: true

# safer than nuking all of ~, but adjust to taste
- clean: ['~/.config']

- create:
    - ~/.config
    - ~/.local/bin
    - ~/.config/systemd/user

- link:
    # fish
    ~/.config/fish/config.fish: config/fish/config.fish
    # kitty
    ~/.config/kitty/kitty.conf: config/kitty/kitty.conf
    # rofi
    ~/.config/rofi/config.rasi: config/rofi/config.rasi
    ~/.config/rofi/onedark.rasi: config/rofi/onedark.rasi
    # hyprland + hyprlock + hyprpaper
    ~/.config/hypr/hyprland.conf: config/hypr/hyprland.conf
    ~/.config/hypr/hyprlock.conf: config/hypr/hyprlock.conf
    ~/.config/hypr/hyprpaper.conf: config/hypr/hyprpaper.conf
    # starship
    ~/.config/starship.toml: config/starship/starship.toml
    # extras from xdg.configFile.*
    ~/.config/qtile: config/qtile
    ~/.config/waybar: config/waybar
    ~/.config/files: config/files
    ~/.config/nvim: config/nvim
    ~/.config/scripts: config/scripts

# ---- Repo packages via omnipkg ----
- omnipkg:
  - install:
    - pipewire
    - vim
    - wget
    - fish
    - firefox
    - rofi-wayland
    - git
    - jq
    - cmake
    - make
    - gcc
    - libtool
    - bluez
    - bitwarden
    - ripgrep
    - waybar
    - hyprpaper
    - kanshi
    - thunderbird
    - discord
    - starship
    - base-devel
    - xdg-desktop-portal
    - xdg-desktop-portal-gtk
    - wl-clipboard
    - grim
    - slurp
    - xdg-utils
    - hyprlock
    - hyprshot
    - ttf-sourcecodepro-nerd

# ---- AUR packages via yay ----
- yay:
  - xdg-desktop-portal-hyprland

# ---- Post steps ----
- shell:
    - description: "Enable lingering for user services"
      command: |
        if command -v loginctl >/dev/null; then
          loginctl enable-linger "$USER" || true
        fi

    - description: "Refresh font cache"
      command: |
        [[ -d "$HOME/.local/share/fonts" ]] && fc-cache -f || true
